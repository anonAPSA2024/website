[
  {
    "objectID": "Research.html",
    "href": "Research.html",
    "title": "Grant Materials",
    "section": "",
    "text": "Knowledge of Job Insecurity and Policy Preferences"
  },
  {
    "objectID": "Research.html#online-supplementary-materials",
    "href": "Research.html#online-supplementary-materials",
    "title": "Grant Materials",
    "section": "",
    "text": "Knowledge of Job Insecurity and Policy Preferences"
  },
  {
    "objectID": "chap2_power_survey.html#experiment-power-analysis-code",
    "href": "chap2_power_survey.html#experiment-power-analysis-code",
    "title": "Power Analysis for the Experiment",
    "section": "Experiment Power Analysis Code",
    "text": "Experiment Power Analysis Code\n\n    \n    \n    Embed R File\n    \n\n\n\nSurvey Power Analysis\n\n#####################################\n# From Scratch Power Analysis Monte Carlo\n######################################\n\n# Clear Environment\nrm(list=ls())\n\n\nset.seed(209365)\n\nlibrary(EnvStats)\nlibrary(truncnorm)\nlibrary(ggplot2)\nlibrary(haven)\nlibrary(readr)\nlibrary(tidyverse)\nlibrary(MASS)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(faux)\nlibrary(lubridate)\nlibrary(truncnorm)\nlibrary(scales)\n\n\nset.seed(92351235)\n\n\n\n# Create a timing function for the power analysis\n\ndhms &lt;- function(t){\n  paste(t %/% (60*60*24) \n        ,paste(formatC(t %/% (60*60) %% 24, width = 2, format = \"d\", flag = \"0\")\n               ,formatC(t %/% 60 %% 60, width = 2, format = \"d\", flag = \"0\")\n               ,formatC(t %% 60, width = 2, format = \"d\", flag = \"0\")\n               ,sep = \":\"\n        )\n  )\n}\n\n\n# Objective Risk\nb1_vector &lt;- c(.2, .5)\n\n# Perceived Risk\nb2_vector &lt;- c(.2,.5)\n\n# Spillover\nb3_vector &lt;- c(.2, .5)\n\n# Certainty\nb4_vector &lt;- c(.2)\n\n#Certainty*Perception\n#More certainty, stronger effect of perceived risks\nb5_vector &lt;- c(.2,.5)\n\n#Certainty*Spillover\n# more certainty, less spillover\nb6_vector &lt;- c(-.2, -.5)\n\n# Correlation\nb7_vector &lt;- c(.5)\n\n\n\n\n\n\n\n# Sample Size Vector\ninput_sample_size_vector &lt;- seq(from=250, to=4500, by=250)\n\n\n\na &lt;- 1\nc &lt;- 1\nnumber_of_samples &lt;- 100\n\n\npower_mc_hypo &lt;- function(b1_vector, b2_vector, b3_vector, b4_vector, b5_vector, b6_vector,\n                          b7_vector,input_sample_size_vector, number_of_samples){\n  \n  \n  \n  permutations &lt;- expand.grid(b1_vector, b2_vector, b3_vector, b4_vector, b5_vector, b6_vector,\n                              b7_vector, input_sample_size_vector)\n  \n  \n  permutations &lt;- dplyr::rename(permutations, beta1=Var1, beta2=Var2, beta3=Var3,\n                                beta4=Var4, beta5=Var5, beta6=Var6, beta7=Var7, sample_size=Var8)\n  \n  startTimeTotal &lt;- Sys.time()\n  for(a in 1:nrow(permutations)){\n    beta1_temp &lt;- permutations$beta1[a]\n    beta2_temp &lt;- permutations$beta2[a]\n     beta3_temp &lt;- permutations$beta3[a]\n    beta4_temp &lt;- permutations$beta4[a]\n    beta5_temp &lt;- permutations$beta5[a]\n    beta6_temp &lt;- permutations$beta6[a]\n    beta7_temp &lt;- permutations$beta7[a]\n\n     sample_size &lt;- permutations$sample_size[a]\n\n    \n    \n    startTime &lt;- Sys.time() \n    \n    \n    \n    c_data &lt;-as.data.frame(matrix(data=NA, \n                                  nrow=(number_of_samples),\n                                  ncol=37))\n    \n    \n    c_data &lt;- rename(c_data, \n                     H1_agg_mig = V1,\n                     H1_agg_auto = V2,\n                     H1_agg_off = V3,\n                     H1_agg_imp = V4,\n                     H2_agg_mig = V5,\n                     H2_agg_auto = V6,\n                     H2_agg_off = V7,\n                     H2_agg_imp = V8,\n                     H3_agg_mig = V9,\n                     H3_agg_auto = V10,\n                     H3_agg_off = V11,\n                     H3_agg_imp = V12,\n                     H4_agg_mig = V13,\n                     H4_agg_auto = V14,\n                     H4_agg_off = V15,\n                     H4_agg_imp = V16,\n                     H5_agg_auto = V18,\n                     H5_agg_off = V19,\n                     H5_agg_imp = V20,\n                     H6_agg_mig = V21,\n                     H6_agg_auto = V22,\n                     H6_agg_off = V23,\n                     H6_agg_imp = V24,\n                     H7_agg_mig = V25,\n                     H7_agg_auto = V26,\n                     H7_agg_off = V27,\n                     H7_agg_imp = V28,\n                     sample_size=V29,\n                     correlation=V30,\n                     beta1=V31,\n                     beta2=V32,\n                     beta3=V33,\n                     beta4=V34,\n                     beta5=V35,\n                     beta6=V36,\n                     beta7=V37\n    )\n    \n    \n    for(c in 1:number_of_samples){\n      \n      ind_sample &lt;-as.data.frame(matrix(data=NA, \n                                        nrow=(sample_size),\n                                        ncol=1))\n      \n      \n      ind_sample$id &lt;- seq(from=1, to=sample_size, by=1)\n      \n      \n      county_fe &lt;- seq(from=-1, to=1, length.out=3234)\n      state &lt;- seq(from=1, to=50, by=1 )\n      occ &lt;- seq(from=0, to=1, length.out=426)\n\n      ind_sample$county_fe &lt;- sample(county_fe, sample_size, replace=TRUE)\n      ind_sample$state &lt;- sample(state, sample_size, replace=TRUE)\n      ind_sample$occ &lt;- sample(occ, sample_size, replace=TRUE)\n      \n      ind_sample$off_ind_con &lt;- rtruncnorm(sample_size,0,1,.5,.25)\n      ind_sample$mig_ind_con &lt;-rtruncnorm(sample_size,0,1,.5,.25)\n      ind_sample$auto_ind_con &lt;-rtruncnorm(sample_size,0,1,.5,.25)\n      ind_sample$imp_ind_con &lt;-rtruncnorm(sample_size,0,1,.5,.25)\n      \n   \n      \n\n\n      ind_sample$off_ind &lt;- ind_sample$off_ind_con\n      ind_sample$mig_ind &lt;- ind_sample$mig_ind_con\n      ind_sample$auto_ind &lt;- ind_sample$auto_ind_con\n      ind_sample$imp_ind &lt;- ind_sample$imp_ind_con\n\n      \n      state_risks &lt;- ind_sample %&gt;%\n                    group_by(state) %&gt;%\n                    dplyr::summarise(state_mig= mean(mig_ind_con),\n                                     state_off= mean(off_ind_con),\n                                     state_auto= mean(auto_ind_con),\n                                     state_imp= mean(imp_ind_con),\n                                     )\n      \n   \n      ind_sample &lt;- merge(ind_sample, state_risks, by=(\"state\"))\n      \n      \n      ind_sample$union &lt;- rbinom(sample_size, size=1, prob=.1)\n      ind_sample$party &lt;- rbinom(sample_size, size=1, prob=.5)\n      \n      ind_sample$cor_temp &lt;- .2 + beta7_temp*ind_sample$union\n      \n      union &lt;- subset(ind_sample, ind_sample$union==1)\n      nonunion &lt;- subset(ind_sample, ind_sample$union==0)\n      \n      union$off_ind_pec &lt;- rnorm_pre(union$off_ind, mu=.5, sd=.25, r=.5)\n      union$mig_ind_pec &lt;- rnorm_pre(union$mig_ind, mu=.5, sd=.25, r=.5)\n      union$auto_ind_pec &lt;- rnorm_pre(union$auto_ind, mu=.5, sd=.25, r=.5)\n      union$imp_ind_pec &lt;- rnorm_pre(union$imp_ind, mu=.5, sd=.25, r=.5)\n    \n      union$mig_acc &lt;- cor(union$mig_ind, union$mig_ind_pec)\n      union$off_acc &lt;- cor(union$off_ind, union$off_ind_pec)\n      union$auto_acc &lt;-cor(union$auto_ind, union$auto_ind_pec)\n      union$imp_acc &lt;- cor(union$imp_ind, union$imp_ind_pec)\n      \n      nonunion$off_ind_pec &lt;- rnorm_pre(nonunion$off_ind, mu=.5, sd=.25, r=.2)\n      nonunion$mig_ind_pec &lt;- rnorm_pre(nonunion$mig_ind, mu=.5, sd=.25, r=.2)\n      nonunion$auto_ind_pec &lt;- rnorm_pre(nonunion$auto_ind, mu=.5, sd=.25, r=.2)\n      nonunion$imp_ind_pec &lt;- rnorm_pre(nonunion$imp_ind, mu=.5, sd=.25, r=.2)\n      \n      \n      nonunion$mig_acc &lt;- cor(nonunion$mig_ind, nonunion$mig_ind_pec)\n      nonunion$off_acc &lt;- cor(nonunion$off_ind, nonunion$off_ind_pec)\n      nonunion$auto_acc &lt;-cor(nonunion$auto_ind, nonunion$auto_ind_pec)\n      nonunion$imp_acc &lt;- cor(nonunion$imp_ind, nonunion$imp_ind_pec)\n      \n      ind_sample &lt;- rbind(union, nonunion)\n      \n      \n    # occ_sample &lt;- ind_sample %&gt;%\n    #     group_by(occ) %&gt;%\n    #     dplyr::summarise(mig_ind2= mean(mig_ind_pec),\n    #                      off_ind2= mean(off_ind_pec),\n    #                      auto_ind2= mean(auto_ind_pec),\n    #                      imp_ind2= mean(imp_ind_pec),\n    #     )\n    #   \n    # \n    # ind_sample$mig_acc2 &lt;- abs(ind_sample$mig_ind_pec - ind_sample$mig_ind2)\n    # ind_sample$mig_acc2 &lt;- abs(ind_sample$mig_ind_pec - ind_sample$mig_ind2)\n    # ind_sample$mig_acc2 &lt;- abs(ind_sample$mig_ind_pec - ind_sample$mig_ind2)\n    # ind_sample$mig_acc2 &lt;- abs(ind_sample$mig_ind_pec - ind_sample$mig_ind2)\n    \n  #  ind_sample &lt;- merge(ind_sample, occ_sample, by=c(\"occ\"))\n      \n      \n      ind_sample$off_ind_cer &lt;- rbinom(sample_size, size=1, prob=.5)\n      \n      ind_sample$mig_ind_cer &lt;-rbinom(sample_size, size=1, prob=.5)\n      ind_sample$auto_ind_cer &lt;-rbinom(sample_size, size=1, prob=.5)\n      ind_sample$imp_ind_cer &lt;-rbinom(sample_size, size=1, prob=.5)\n      \n      # \n      # ind_sample$off_ind_cer &lt;- ntile(ind_sample$off_ind_cer, 7)\n      # ind_sample$mig_ind_cer &lt;- ntile(ind_sample$mig_ind_cer, 7)\n      # ind_sample$auto_ind_cer &lt;- ntile(ind_sample$auto_ind_cer, 7)\n      # ind_sample$imp_ind_cer &lt;- ntile(ind_sample$imp_ind_cer, 7)\n      # \n      ind_sample$not_off_ind &lt;- ind_sample$mig_ind + ind_sample$auto_ind + ind_sample$imp_ind\n      ind_sample$not_mig_ind &lt;- ind_sample$off_ind + ind_sample$auto_ind + ind_sample$imp_ind\n      ind_sample$not_auto_ind &lt;- ind_sample$mig_ind + ind_sample$off_ind + ind_sample$imp_ind\n      ind_sample$not_imp_ind &lt;- ind_sample$mig_ind + ind_sample$auto_ind + ind_sample$off_ind\n      \n      \n      # ind_sample$not_off_ind &lt;- ntile(ind_sample$not_off_ind, 7)\n      # ind_sample$not_mig_ind &lt;- ntile(ind_sample$not_mig_ind, 7)\n      # ind_sample$not_auto_ind &lt;- ntile(ind_sample$not_auto_ind, 7)\n      # ind_sample$not_imp_ind &lt;- ntile(ind_sample$not_imp_ind, 7)\n      \n      \n      \n \n  \n\n      ind_sample$error &lt;- rnorm(sample_size,0,.5)\n      \n    \n      \n\n      \n      ind_sample$mig_opp_og &lt;- ind_sample$county_fe+ #County Fixed Effects\n                            beta1_temp*ind_sample$mig_ind +\n                            beta2_temp*ind_sample$mig_ind_pec +\n                          beta3_temp*ind_sample$not_mig_ind +\n                            beta4_temp*ind_sample$mig_ind_cer+\n                            beta5_temp*(ind_sample$mig_ind_cer*ind_sample$mig_ind_pec)+\n                            beta6_temp*(ind_sample$mig_ind_cer*ind_sample$not_mig_ind)+\n                             .2*ind_sample$state_mig + ind_sample$error\n      \n      \n      ind_sample$mig_opp_og_higher &lt;- ind_sample$county_fe+ #County Fixed Effects\n        beta1_temp*ind_sample$mig_ind +\n        beta2_temp*ind_sample$mig_ind_pec +\n        (beta3_temp+.2)*ind_sample$not_mig_ind +\n        beta4_temp*ind_sample$mig_ind_cer+\n        beta5_temp*(ind_sample$mig_ind_cer*ind_sample$mig_ind_pec)+\n        beta6_temp*(ind_sample$mig_ind_cer*ind_sample$not_mig_ind)+\n        .2*ind_sample$state_mig + ind_sample$error\n      \n      \n      \n      \n      \n      ind_sample$off_opp_og &lt;- ind_sample$county_fe+ #County Fixed Effects\n        beta1_temp*ind_sample$off_ind +\n        beta2_temp*ind_sample$off_ind_pec +\n        beta3_temp*ind_sample$not_off_ind +\n        beta4_temp*ind_sample$off_ind_cer+\n        beta5_temp*(ind_sample$off_ind_cer*ind_sample$off_ind_pec)+\n        beta6_temp*(ind_sample$off_ind_cer*ind_sample$not_off_ind)+\n        .2*ind_sample$state_off +  ind_sample$error\n      \n      \n      ind_sample$auto_opp_og &lt;- ind_sample$county_fe+ #County Fixed Effects\n        beta1_temp*ind_sample$auto_ind +\n        beta2_temp*ind_sample$auto_ind_pec +\n        beta3_temp*ind_sample$not_auto_ind +\n        beta4_temp*ind_sample$auto_ind_cer+\n        beta5_temp*(ind_sample$auto_ind_cer*ind_sample$auto_ind_pec)+\n        beta6_temp*(ind_sample$auto_ind_cer*ind_sample$not_auto_ind)+\n        .2*ind_sample$state_auto + ind_sample$error\n      \n      \n      \n      ind_sample$imp_opp_og &lt;- ind_sample$county_fe+ #County Fixed Effects\n        beta1_temp*ind_sample$imp_ind +\n        beta2_temp*ind_sample$imp_ind_pec +\n        beta3_temp*ind_sample$not_imp_ind +\n        beta4_temp*ind_sample$imp_ind_cer+\n        beta5_temp*(ind_sample$imp_ind_cer*ind_sample$imp_ind_pec)+\n        beta6_temp*(ind_sample$imp_ind_cer*ind_sample$not_imp_ind)+\n        .2*ind_sample$state_imp+  ind_sample$error\n      \n      \n      \n      ## Turn outcome variables into 7 categories\n      ind_sample$mig_opp &lt;- ntile(ind_sample$mig_opp_og, 7)\n      ind_sample$off_opp &lt;- ntile(ind_sample$off_opp_og, 7)\n      ind_sample$auto_opp &lt;- ntile(ind_sample$auto_opp_og, 7)\n      ind_sample$imp_opp &lt;-  ntile(ind_sample$imp_opp_og, 7)\n      ind_sample$mig_opp_higher &lt;- ntile(ind_sample$mig_opp_og_higher, 7)\n\n                 \n      \n      #########################\n      # Hypothesis 1\n      #########################\n      \n      # Workers who have greater occupational susceptibility towards an economic\n     # process should oppose it more than workers with lower susceptibility.\n\n      temp &lt;- summary(lm(mig_opp ~ mig_ind +mig_ind_pec*mig_ind_cer +not_mig_ind*mig_ind_cer +county_fe + state_mig, data=ind_sample))\n      c_data$H1_agg_mig[c] &lt;-ifelse(temp$coefficients[2,4]&lt;.05&\n                                temp$coefficients[2,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(off_opp ~ off_ind +off_ind_pec*off_ind_cer +not_off_ind*off_ind_cer +county_fe + state_off, data=ind_sample))\n      c_data$H1_agg_off[c] &lt;-ifelse(temp$coefficients[2,4]&lt;.05&\n                                      temp$coefficients[2,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(auto_opp ~ auto_ind +auto_ind_pec*auto_ind_cer +not_auto_ind*auto_ind_cer +county_fe + state_auto, data=ind_sample))\n      c_data$H1_agg_auto[c] &lt;-ifelse(temp$coefficients[2,4]&lt;.05&\n                                      temp$coefficients[2,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(imp_opp ~ imp_ind +imp_ind_pec*imp_ind_cer +not_imp_ind*imp_ind_cer +county_fe + state_imp, data=ind_sample))\n      c_data$H1_agg_imp[c] &lt;-ifelse(temp$coefficients[2,4]&lt;.05&\n                                      temp$coefficients[2,1]&gt;0,1,0)\n      \n      \n      \n      #########################\n      # Hypothesis 2\n      #\n      # Workers who have greater perceived susceptibility towards an economic process\n      # should oppose it more than workers with lower susceptibility.\n      #########################\n      \n      temp &lt;- summary(lm(mig_opp ~ mig_ind +mig_ind_pec*mig_ind_cer +not_mig_ind*mig_ind_cer +county_fe + state_mig, data=ind_sample))\n      c_data$H2_agg_mig[c] &lt;-ifelse(temp$coefficients[3,4]&lt;.05&\n                                      temp$coefficients[3,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(off_opp ~ off_ind +off_ind_pec*off_ind_cer +not_off_ind*off_ind_cer +county_fe + state_off, data=ind_sample))\n      c_data$H2_agg_off[c] &lt;-ifelse(temp$coefficients[3,4]&lt;.05&\n                                      temp$coefficients[3,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(auto_opp ~ auto_ind +auto_ind_pec*auto_ind_cer +not_auto_ind*auto_ind_cer +county_fe + state_auto, data=ind_sample))\n      c_data$H2_agg_auto[c] &lt;-ifelse(temp$coefficients[3,4]&lt;.05&\n                                      temp$coefficients[3,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(imp_opp ~ imp_ind +imp_ind_pec*imp_ind_cer +not_imp_ind*imp_ind_cer +county_fe + state_imp, data=ind_sample))\n      c_data$H2_agg_imp[c] &lt;-ifelse(temp$coefficients[3,4]&lt;.05&\n                                      temp$coefficients[3,1]&gt;0,1,0)\n      \n      \n      #########################\n      # Hypothesis 3\n      #\n      #Perceived susceptibility towards an option should have a greater effect\n      # on policy support than objective susceptibility.\n      #########################\n      \n      \n      temp &lt;- summary(lm(mig_opp ~ mig_ind +mig_ind_pec*mig_ind_cer +not_mig_ind*mig_ind_cer +county_fe + state_mig, data=ind_sample))\n      c_data$H3_agg_mig[c] &lt;-ifelse(temp$coefficients[3,4]&lt;.05&\n                                      temp$coefficients[3,1]&gt;temp$coefficients[2,1],1,0)\n      \n      \n      temp &lt;- summary(lm(off_opp ~ off_ind +off_ind_pec*off_ind_cer +not_off_ind*off_ind_cer +county_fe + state_off, data=ind_sample))\n      c_data$H3_agg_off[c] &lt;-ifelse(temp$coefficients[3,4]&lt;.05&\n                                      temp$coefficients[3,1]&gt;temp$coefficients[2,1],1,0)\n      \n      \n      temp &lt;- summary(lm(auto_opp ~ auto_ind +auto_ind_pec*auto_ind_cer +not_auto_ind*auto_ind_cer +county_fe + state_auto, data=ind_sample))\n      c_data$H3_agg_auto[c] &lt;-ifelse(temp$coefficients[3,4]&lt;.05&\n                                       temp$coefficients[3,1]&gt;temp$coefficients[2,1],1,0)\n      \n      \n      temp &lt;- summary(lm(imp_opp ~ imp_ind +imp_ind_pec*imp_ind_cer +not_imp_ind*imp_ind_cer +county_fe + state_imp, data=ind_sample))\n      c_data$H3_agg_imp[c] &lt;-ifelse(temp$coefficients[3,4]&lt;.05&\n                                      temp$coefficients[3,1]&gt;temp$coefficients[2,1],1,0)\n      \n      \n      \n      \n      \n      ######################\n      # Hypothesis 4\n      #\n      # Respondents who are more uncertain about the risks to their occupation \n      # should be more likely to oppose all options than respondents who are \n      # certain about their risks.\n      #\n      #######################\n      temp &lt;- summary(lm(mig_opp ~ mig_ind +mig_ind_pec*mig_ind_cer +not_mig_ind*mig_ind_cer +county_fe + state_mig, data=ind_sample))\n      c_data$H4_agg_mig[c] &lt;-ifelse(temp$coefficients[5,4]&lt;.05&\n                                      temp$coefficients[5,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(off_opp ~ off_ind +off_ind_pec*off_ind_cer +not_off_ind*off_ind_cer +county_fe + state_off, data=ind_sample))\n      c_data$H4_agg_off[c] &lt;-ifelse(temp$coefficients[5,4]&lt;.05&\n                                      temp$coefficients[5,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(auto_opp ~ auto_ind +auto_ind_pec*auto_ind_cer +not_auto_ind*auto_ind_cer +county_fe + state_auto, data=ind_sample))\n      c_data$H4_agg_auto[c] &lt;-ifelse(temp$coefficients[5,4]&lt;.05&\n                                       temp$coefficients[5,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(imp_opp ~ imp_ind +imp_ind_pec*imp_ind_cer +not_imp_ind*imp_ind_cer +county_fe + state_imp, data=ind_sample))\n      c_data$H4_agg_imp[c] &lt;-ifelse(temp$coefficients[5,4]&lt;.05&\n                                      temp$coefficients[5,1]&gt;0,1,0)\n      \n      #########################\n      # Hypothesis 5\n      #\n      #Respondents who are more uncertain about the risks to their occupation\n      # should be more likely to oppose migration than other policies. \n      #########################\n      temp_mig &lt;- summary(lm(mig_opp_higher ~ mig_ind +mig_ind_pec*mig_ind_cer +not_mig_ind*mig_ind_cer +county_fe + state_mig, data=ind_sample))\n      \n      \n      \n      temp_off &lt;- summary(lm(off_opp ~ off_ind +off_ind_pec*off_ind_cer +not_off_ind*off_ind_cer +county_fe + state_off, data=ind_sample))\n      \n      \n      temp_auto &lt;- summary(lm(auto_opp ~ auto_ind +auto_ind_pec*auto_ind_cer +not_auto_ind*auto_ind_cer +county_fe + state_auto, data=ind_sample))\n      \n      \n      \n      temp_imp &lt;- summary(lm(imp_opp ~ imp_ind +imp_ind_pec*imp_ind_cer +not_imp_ind*imp_ind_cer +county_fe + state_imp, data=ind_sample))\n      \n      \n      c_data$H5_agg_auto &lt;- ifelse(temp_mig$coefficients[5,1]&gt;temp_auto$coefficients[5,1] &\n                                     temp_mig$coefficients[5,4]&lt;.05,1,0)\n      \n      c_data$H5_agg_imp &lt;- ifelse(temp_mig$coefficients[5,1]&gt;temp_imp$coefficients[5,1] &\n                                    temp_mig$coefficients[5,4]&lt;.05,1,0)\n      \n      c_data$H5_agg_off &lt;- ifelse(temp_mig$coefficients[5,1]&gt;temp_off$coefficients[5,1] &\n                                    temp_mig$coefficients[5,4]&lt;.05,1,0)\n      \n      \n      \n      \n\n      \n      ###############################\n      # Hypothesis 6\n      #\n      # Respondents with greater certainty in their perceived individual risk will oppose\n      # a policy more than a less certain respondent with similar risk\n      #\n      ###############################\n      \n      \n      \n      temp &lt;- summary(lm(mig_opp ~ mig_ind +mig_ind_pec*mig_ind_cer +not_mig_ind*mig_ind_cer +county_fe + state_mig, data=ind_sample))\n      c_data$H6_agg_mig[c] &lt;-ifelse(temp$coefficients[8,4]&lt;.05&\n                                      temp$coefficients[8,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(off_opp ~ off_ind +off_ind_pec*off_ind_cer +not_off_ind*off_ind_cer +county_fe + state_off, data=ind_sample))\n      c_data$H6_agg_off[c] &lt;-ifelse(temp$coefficients[8,4]&lt;.05&\n                                      temp$coefficients[8,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(auto_opp ~ auto_ind +auto_ind_pec*auto_ind_cer +not_auto_ind*auto_ind_cer +county_fe + state_auto, data=ind_sample))\n      c_data$H6_agg_auto[c] &lt;-ifelse(temp$coefficients[8,4]&lt;.05&\n                                       temp$coefficients[8,1]&gt;0,1,0)\n      \n      \n      temp &lt;- summary(lm(imp_opp ~ imp_ind +imp_ind_pec*imp_ind_cer +not_imp_ind*imp_ind_cer +county_fe + state_imp, data=ind_sample))\n      c_data$H6_agg_imp[c] &lt;-ifelse(temp$coefficients[8,4]&lt;.05&\n                                      temp$coefficients[8,1]&gt;0,1,0)\n      \n      \n      \n      \n      \n      #############\n      # Hypothesis 7\n      #\n      # Union Members will have more accurate perceptions of their susceptibility \n      # to these economic processes than non-union members\n      ################\n      temp &lt;- summary(lm(mig_acc ~ union, data=ind_sample))\n      c_data$H7_agg_mig[c] &lt;-ifelse(temp$coefficients[2,4]&lt;.05&\n                                      temp$coefficients[2,1]&gt;0,1,0)\n      \n      temp &lt;- summary(lm(off_acc ~ union, data=ind_sample))\n      c_data$H7_agg_off[c] &lt;-ifelse(temp$coefficients[2,4]&lt;.05&\n                                      temp$coefficients[2,1]&gt;0,1,0)\n      \n      temp &lt;- summary(lm(auto_acc ~ union, data=ind_sample))\n      c_data$H7_agg_auto[c] &lt;-ifelse(temp$coefficients[2,4]&lt;.05&\n                                      temp$coefficients[2,1]&gt;0,1,0)\n      \n      temp &lt;- summary(lm(imp_acc ~ union, data=ind_sample))\n      c_data$H7_agg_imp[c] &lt;-ifelse(temp$coefficients[2,4]&lt;.05&\n                                      temp$coefficients[2,1]&gt;0,1,0)\n      \n      \n\n      \n      \n      \n      #######################\n      # Export True DGP Data\n      #########################\n\n      c_data$sample_size[c] &lt;- sample_size\n      c_data$beta1[c] &lt;- beta1_temp\n      c_data$beta2[c] &lt;- beta2_temp\n      c_data$beta3[c] &lt;- beta3_temp\n      c_data$beta4[c] &lt;- beta4_temp\n      c_data$beta5[c] &lt;- beta5_temp\n      c_data$beta6[c] &lt;- beta6_temp\n      c_data$beta7[c] &lt;- beta7_temp\n\n\n      \n      \n    }\n    \n    \n    \n    if(a==1){b_data &lt;- c_data}else{\n      b_data &lt;- rbind(b_data, c_data)}\n    \n    \n    \n    endTime &lt;- Sys.time() \n    \n    \n    \n    cat(paste0(\"Loop \", a,\"/\", nrow(permutations), \"\\n\",\n               \"Loop Duration: \", round(as.numeric(endTime-startTime),2), \" seconds\"),\"\\n\",\n        \"Total Duration: \", dhms(as.numeric(endTime)-as.numeric(startTimeTotal)),\"\\n\",\"###############\",\"\\n\")\n  }\n  \n  \n  return(b_data)\n}\n\nmc_data &lt;- power_mc_hypo(b1_vector = b1_vector,\n                         b2_vector = b2_vector,\n                         b3_vector = b3_vector,\n                         b4_vector = b4_vector,\n                         b5_vector = b5_vector,\n                         b6_vector = b6_vector,\n                         b7_vector = b7_vector,\n                         number_of_samples = 100,\n                         input_sample_size_vector=input_sample_size_vector)\n\n\n\n\nwrite_dta(mc_data, \n          \"survey_power_analysis.dta\")"
  },
  {
    "objectID": "chap2_power_survey.html#data-download",
    "href": "chap2_power_survey.html#data-download",
    "title": "Power Analysis for the Experiment",
    "section": "Data Download",
    "text": "Data Download\n\n\n    \n    \n    Download .dta File\n    \n\n\n\nDownload Survey Power Analysis Results .dta file\nDownload"
  },
  {
    "objectID": "chap2_occ_plot.html",
    "href": "chap2_occ_plot.html",
    "title": "European Social Survey 2014 Occupation Plot Replication Materials",
    "section": "",
    "text": "View-Only File\n\n\n\n\n\n    &lt;h1&gt;View-Only Content&lt;/h1&gt;\n    &lt;p&gt;This is a sample text that is view-only. You cannot select, copy, or edit this text.&lt;/p&gt;\n&lt;/div&gt;"
  },
  {
    "objectID": "chap2.html",
    "href": "chap2.html",
    "title": "Overview",
    "section": "",
    "text": "Power Analysis R-File\nData Codebook\nAnonymized Full Pilot Experiment\nAnonymized Full Experiment\nAnonymized IRB Application\nAnonymized Experiment Preregistration"
  },
  {
    "objectID": "chap2.html#section-b-experiment-materials",
    "href": "chap2.html#section-b-experiment-materials",
    "title": "Overview",
    "section": "",
    "text": "Power Analysis R-File\nData Codebook\nAnonymized Full Pilot Experiment\nAnonymized Full Experiment\nAnonymized IRB Application\nAnonymized Experiment Preregistration"
  },
  {
    "objectID": "chap2.html#section-c-survey-materials",
    "href": "chap2.html#section-c-survey-materials",
    "title": "Overview",
    "section": "Section C: Survey Materials",
    "text": "Section C: Survey Materials\nData Generation R-File\nPower Analysis Plots R-File\nPower Analysis Justification\nSurvey Provider Justification\nData Codebook\nAnonymized Survey\nAnonymized IRB Application"
  },
  {
    "objectID": "chap2.html#previously-received-grants",
    "href": "chap2.html#previously-received-grants",
    "title": "Overview",
    "section": "Previously Received Grants",
    "text": "Previously Received Grants\nAnonymized Dissertation Grant Received\nAnonymized Dissertation Grant Extension"
  },
  {
    "objectID": "chap2_power_experiment.html",
    "href": "chap2_power_experiment.html",
    "title": "Power Analysis for the Experiment",
    "section": "",
    "text": "Embed R File\n    \n\n\n\nSurvey Power Analysis\n\n#####################################\n# From Scratch Power Analysis Monte Carlo\n######################################\n\n# Clear Environment\nrm(list=ls())\n\n\nset.seed(209365)\n\nlibrary(EnvStats)\nlibrary(truncnorm)\nlibrary(ggplot2)\nlibrary(haven)\nlibrary(readr)\nlibrary(tidyverse)\nlibrary(MASS)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(faux)\nlibrary(lubridate)\n\n\ndhms &lt;- function(t){\n  paste(t %/% (60*60*24) \n        ,paste(formatC(t %/% (60*60) %% 24, width = 2, format = \"d\", flag = \"0\")\n               ,formatC(t %/% 60 %% 60, width = 2, format = \"d\", flag = \"0\")\n               ,formatC(t %% 60, width = 2, format = \"d\", flag = \"0\")\n               ,sep = \":\"\n        )\n  )\n}\n\nb1_vector &lt;- c(.2, .5)\nb2_vector &lt;- c(.2, .5)\nb3_vector &lt;- c(.2)\n\ninput_sample_size_vector &lt;- seq(from=500, to=3000, by=100)\n\ncor_vector &lt;- c(.2,.5,.8)\n\n\ntreatment_weight &lt;- list(c(.1666,.1666,.1666,.1666,.1666,.1666))\n\n#treatment_weight &lt;- list(c(.25,.1,.1,.25,.15,.15),c(.1666,.1666,.1666,.1666,.1666,.1666))\n\n\npower_mc &lt;- function(b1_vector, b2_vector, b3_vector,  cor_vector, number_of_samples, input_sample_size_vector, treatment_weight){\n  \n  \n  permutations &lt;- expand.grid(b1_vector, b2_vector, b3_vector,\n                              input_sample_size_vector, cor_vector, treatment_weight)\n  \n  \n  permutations &lt;- dplyr::rename(permutations, beta1=Var1, beta2=Var2, beta3=Var3,\n                                sample_size=Var4, cor=Var5, treatment_weight=Var6)\n  \n  \n  \n\n  for(a in 1:nrow(permutations)){\n    cor_temp &lt;- permutations$cor[a]\n    beta1_temp &lt;- permutations$beta1[a]\n    beta2_temp &lt;- permutations$beta2[a]\n    beta3_temp &lt;- permutations$beta3[a]\n    sample_size &lt;- permutations$sample_size[a]\n    treatment_weight_temp &lt;- permutations$treatment_weight[[a]]\n\n\n\n\n\n      \n      \n      c_data &lt;-as.data.frame(matrix(data=NA, \n                                    nrow=(number_of_samples),\n                                    ncol=30))\n      \n      c_data &lt;- rename(c_data, \n                       con1_mig=V1,\n                       con1_off=V2,\n                       con1_auto=V3,\n                       con1_imp=V4,\n                       con2_mig=V5,\n                       con2_off=V6,\n                       con2_auto=V7,\n                       con2_imp=V8,\n                       con3_mig=V9,\n                       con3_off=V10,\n                       con3_auto=V11,\n                       con3_imp=V12,\n                       con4_mig=V13,\n                       con4_off=V14,\n                       con4_auto=V15,\n                       con4_imp=V16,\n                       con5_mig=V17,\n                       con5_off=V18,\n                       con5_auto=V19,\n                       con5_imp=V20,\n                       con6_mig=V21,\n                       con6_off=V22,\n                       con6_auto=V23,\n                       con6_imp=V24,\n                       sample_size=V25,\n                       correlation=V26,\n                       beta1=V27,\n                       beta2=V28,\n                       beta3=V29,\n                       treatment_weight=V30\n      )\n      \n   \n      for(c in 1:number_of_samples){\n      \n      ind_sample &lt;-as.data.frame(matrix(data=NA, \n                                        nrow=(sample_size),\n                                        ncol=29))\n      \n      \n      ind_sample &lt;- rename(ind_sample,\n                           y_mig_b=V1,\n                           y_imp_b=V2,\n                           y_auto_b=V3,\n                           y_off_b=V4,\n                           y_mig_1=V5,\n                           y_imp_1=V6,\n                           y_auto_1=V7,\n                           y_off_1=V8,\n                           y_mig_2=V9,\n                           y_imp_2=V10,\n                           y_auto_2=V11,\n                           y_off_2=V12,\n                           y_mig_3=V13,\n                           y_imp_3=V14,\n                           y_auto_3=V15,\n                           y_off_3=V16,\n                           y_mig_4=V17,\n                           y_imp_4=V18,\n                           y_auto_4=V19,\n                           y_off_4=V20,\n                           y_mig_5=V21,\n                           y_imp_5=V22,\n                           y_auto_5=V23,\n                           y_off_5=V24,\n                           y_mig_6=V25,\n                           y_imp_6=V26,\n                           y_auto_6=V27,\n                           y_off_6=V28,\n                           treatment=V29)\n      \n                      \n      \n    treatments &lt;- c(\"C1\",\"C2\",\"C3\",\"C4\",\"C5\",\"C6\")\n    \n    ind_sample$treatment &lt;- sample(treatments, sample_size, replace=TRUE,\n                                    prob=treatment_weight_temp)\n    ind_sample$y_mig_b &lt;- rnorm(sample_size,0,1)\n    ind_sample$y_imp_b &lt;- rnorm(sample_size,0,1)\n    ind_sample$y_auto_b &lt;- rnorm(sample_size,0,1)\n    ind_sample$y_off_b &lt;- rnorm(sample_size,0,1)\n    \n    \n    ### Condition One (Control, Control)\n    ind_sample$y_mig_1 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_mig_1_dif &lt;- ind_sample$y_mig_1 - ind_sample$y_mig_b\n    ind_sample$y_mig_1_dif &lt;- ifelse(ind_sample$treatment==\"C1\",\n                                  ind_sample$y_mig_1_dif,\n                                  NA)\n    \n  \n    ind_sample$y_auto_1 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_auto_1_dif &lt;- ind_sample$y_auto_1 - ind_sample$y_auto_b\n    ind_sample$y_auto_1_dif &lt;- ifelse(ind_sample$treatment==\"C1\",\n                                     ind_sample$y_auto_1_dif,\n                                     NA)\n    \n    ind_sample$y_imp_1 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_imp_1_dif &lt;- ind_sample$y_imp_1 - ind_sample$y_imp_b\n    ind_sample$y_imp_1_dif &lt;- ifelse(ind_sample$treatment==\"C1\",\n                                     ind_sample$y_imp_1_dif,\n                                     NA)\n    \n    ind_sample$y_off_1 &lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_off_1_dif &lt;- ind_sample$y_off_1 - ind_sample$y_off_b\n    ind_sample$y_off_1_dif &lt;- ifelse(ind_sample$treatment==\"C1\",\n                                     ind_sample$y_off_1_dif,\n                                     NA)\n    \n\n    \n    ### Condition Two  (Control, Offshore)\n    ind_sample$y_mig_2 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_mig_2_dif &lt;- ind_sample$y_mig_2 - ind_sample$y_mig_b\n    ind_sample$y_mig_2_dif &lt;- ifelse(ind_sample$treatment==\"C2\",\n                                     ind_sample$y_mig_2_dif,\n                                     NA)\n    \n    ind_sample$y_auto_2 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_auto_2_dif &lt;- ind_sample$y_auto_2 - ind_sample$y_auto_b\n    ind_sample$y_auto_2_dif &lt;- ifelse(ind_sample$treatment==\"C2\",\n                                     ind_sample$y_auto_2_dif,\n                                     NA)\n    \n    ind_sample$y_imp_2 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_imp_2_dif &lt;- ind_sample$y_imp_2 - ind_sample$y_imp_b\n    ind_sample$y_imp_2_dif &lt;- ifelse(ind_sample$treatment==\"C2\",\n                                     ind_sample$y_imp_2_dif,\n                                     NA)\n    \n    ind_sample$y_off_2 &lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp - 1* beta3_temp\n    ind_sample$y_off_2_dif &lt;- ind_sample$y_off_2 - ind_sample$y_off_b\n    ind_sample$y_off_2_dif &lt;- ifelse(ind_sample$treatment==\"C2\",\n                                     ind_sample$y_off_2_dif,\n                                     NA)\n    \n    \n    \n    \n    ### Condition Three  (General, Control)\n    ind_sample$y_mig_3 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n    ind_sample$y_mig_3_dif &lt;- ind_sample$y_mig_3 - ind_sample$y_mig_b\n    ind_sample$y_mig_3_dif &lt;- ifelse(ind_sample$treatment==\"C3\",\n                                     ind_sample$y_mig_3_dif,\n                                     NA)\n    \n    ind_sample$y_auto_3 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n    ind_sample$y_auto_3_dif &lt;- ind_sample$y_auto_3 - ind_sample$y_auto_b\n    ind_sample$y_auto_3_dif &lt;- ifelse(ind_sample$treatment==\"C3\",\n                                     ind_sample$y_auto_3_dif,\n                                     NA)\n    \n    ind_sample$y_imp_3 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n    ind_sample$y_imp_3_dif &lt;- ind_sample$y_imp_3 - ind_sample$y_imp_b\n    ind_sample$y_imp_3_dif &lt;- ifelse(ind_sample$treatment==\"C3\",\n                                     ind_sample$y_imp_3_dif,\n                                     NA)\n    \n    ind_sample$y_off_3&lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n    ind_sample$y_off_3_dif &lt;- ind_sample$y_off_3 - ind_sample$y_off_b\n    ind_sample$y_off_3_dif &lt;- ifelse(ind_sample$treatment==\"C3\",\n                                     ind_sample$y_off_3_dif,\n                                     NA)\n    \n    \n    \n    \n    ### Condition Four  (General, Offshore)\n    \n    ind_sample$y_mig_4 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n    ind_sample$y_mig_4_dif &lt;- ind_sample$y_mig_4 - ind_sample$y_mig_b\n    ind_sample$y_mig_4_dif &lt;- ifelse(ind_sample$treatment==\"C4\",\n                                     ind_sample$y_mig_4_dif,\n                                     NA)\n    \n    ind_sample$y_auto_4 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n    ind_sample$y_auto_4_dif &lt;- ind_sample$y_auto_4 - ind_sample$y_auto_b\n    ind_sample$y_auto_4_dif &lt;- ifelse(ind_sample$treatment==\"C4\",\n                                     ind_sample$y_auto_4_dif,\n                                     NA)\n    \n    ind_sample$y_imp_4 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n    ind_sample$y_imp_4_dif &lt;- ind_sample$y_imp_4 - ind_sample$y_imp_b\n    ind_sample$y_imp_4_dif &lt;- ifelse(ind_sample$treatment==\"C4\",\n                                     ind_sample$y_imp_4_dif,\n                                     NA)\n    \n    ind_sample$y_off_4&lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp - 1* beta3_temp\n    ind_sample$y_off_4_dif &lt;- ind_sample$y_off_4 - ind_sample$y_off_b\n    ind_sample$y_off_4_dif &lt;- ifelse(ind_sample$treatment==\"C4\",\n                                     ind_sample$y_off_4_dif,\n                                     NA)\n    \n    \n    ### Condition Five  (Auto, Control)\n    \n    ind_sample$y_mig_5 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_mig_5_dif &lt;- ind_sample$y_mig_5 - ind_sample$y_mig_b\n    ind_sample$y_mig_5_dif &lt;- ifelse(ind_sample$treatment==\"C5\",\n                                     ind_sample$y_mig_5_dif,\n                                     NA)\n    \n    ind_sample$y_auto_5 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 1*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_auto_5_dif &lt;- ind_sample$y_auto_5 - ind_sample$y_auto_b\n    ind_sample$y_auto_5_dif &lt;- ifelse(ind_sample$treatment==\"C5\",\n                                     ind_sample$y_auto_5_dif,\n                                     NA)\n    \n    ind_sample$y_imp_5 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_imp_5_dif &lt;- ind_sample$y_imp_5 - ind_sample$y_imp_b\n    ind_sample$y_imp_5_dif &lt;- ifelse(ind_sample$treatment==\"C5\",\n                                     ind_sample$y_imp_5_dif,\n                                     NA)\n    \n    ind_sample$y_off_5&lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_off_5_dif &lt;- ind_sample$y_off_5 - ind_sample$y_off_b\n    ind_sample$y_off_5_dif &lt;- ifelse(ind_sample$treatment==\"C5\",\n                                     ind_sample$y_off_5_dif,\n                                     NA)\n    \n    \n    \n    ### Condition Six  (Auto, Offshore)\n    \n    ind_sample$y_mig_6 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_mig_6_dif &lt;- ind_sample$y_mig_6 - ind_sample$y_mig_b\n    ind_sample$y_mig_6_dif &lt;- ifelse(ind_sample$treatment==\"C6\",\n                                     ind_sample$y_mig_6_dif,\n                                     NA)\n    \n    ind_sample$y_auto_6 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 1*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_auto_6_dif &lt;- ind_sample$y_auto_6 - ind_sample$y_auto_b\n    ind_sample$y_auto_6_dif &lt;- ifelse(ind_sample$treatment==\"C6\",\n                                     ind_sample$y_auto_6_dif,\n                                     NA)\n    \n    ind_sample$y_imp_6 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n    ind_sample$y_imp_6_dif &lt;- ind_sample$y_imp_6 - ind_sample$y_imp_b\n    ind_sample$y_imp_6_dif &lt;- ifelse(ind_sample$treatment==\"C6\",\n                                     ind_sample$y_imp_6_dif,\n                                     NA)\n    \n    ind_sample$y_off_6&lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp - 1* beta3_temp\n    ind_sample$y_off_6_dif &lt;- ind_sample$y_off_6 - ind_sample$y_off_b\n    ind_sample$y_off_6_dif &lt;- ifelse(ind_sample$treatment==\"C6\",\n                                     ind_sample$y_off_6_dif,\n                                     NA)\n    \n    \n    \n    \n    \n    #######\n    # Condition One\n    #######\n    \n    temp &lt;- t.test(ind_sample$y_mig_b, ind_sample$y_mig_1, alternative =\"two.sided\")\n    c_data$con1_mig[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_off_b, ind_sample$y_off_1, alternative =\"two.sided\")\n    c_data$con1_off[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_auto_b, ind_sample$y_auto_1, alternative =\"two.sided\")\n    c_data$con1_auto[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_imp_b, ind_sample$y_imp_1, alternative =\"two.sided\")\n    c_data$con1_imp[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    \n    #######\n    # Condition Two\n    #######\n    \n    temp &lt;- t.test(ind_sample$y_mig_1_dif, ind_sample$y_mig_2_dif, alternative =\"two.sided\")\n    c_data$con2_mig[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_off_1_dif, ind_sample$y_off_2_dif, alternative =\"greater\")\n    c_data$con2_off[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_auto_1_dif, ind_sample$y_auto_2_dif, alternative =\"two.sided\")\n    c_data$con2_auto[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_imp_1_dif, ind_sample$y_imp_2_dif, alternative =\"two.sided\")\n    c_data$con2_imp[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    \n    #######\n    # Condition Three\n    #######\n    \n    temp &lt;- t.test(ind_sample$y_mig_1_dif, ind_sample$y_mig_3_dif, alternative =\"less\")\n    c_data$con3_mig[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_off_1_dif, ind_sample$y_off_3_dif, alternative =\"less\")\n    c_data$con3_off[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_auto_1_dif, ind_sample$y_auto_3_dif, alternative =\"less\")\n    c_data$con3_auto[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_imp_1_dif, ind_sample$y_imp_3_dif, alternative =\"less\")\n    c_data$con3_imp[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    \n    \n    \n    #######\n    # Condition Four\n    #######\n    \n    temp &lt;- t.test(ind_sample$y_mig_1_dif, ind_sample$y_mig_4_dif, alternative =\"less\")\n    c_data$con4_mig[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_off_1_dif, ind_sample$y_off_4_dif, alternative =\"greater\")\n    c_data$con4_off[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_auto_1_dif, ind_sample$y_auto_4_dif, alternative =\"less\")\n    c_data$con4_auto[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_imp_1_dif, ind_sample$y_imp_4_dif, alternative =\"less\")\n    c_data$con4_imp[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    \n    #######\n    # Condition Five\n    #######\n    \n    temp &lt;- t.test(ind_sample$y_mig_1_dif, ind_sample$y_mig_5_dif, alternative =\"two.sided\")\n    c_data$con5_mig[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_off_1_dif, ind_sample$y_off_5_dif, alternative =\"two.sided\")\n    c_data$con5_off[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_auto_1_dif, ind_sample$y_auto_5_dif, alternative =\"less\")\n    c_data$con5_auto[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_imp_1_dif, ind_sample$y_imp_5_dif, alternative =\"two.sided\")\n    c_data$con5_imp[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    #######\n    # Condition Six\n    #######\n    \n    temp &lt;- t.test(ind_sample$y_mig_1_dif, ind_sample$y_mig_6_dif, alternative =\"two.sided\")\n    c_data$con6_mig[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_off_1_dif, ind_sample$y_off_6_dif, alternative =\"greater\")\n    c_data$con6_off[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_auto_1_dif, ind_sample$y_auto_6_dif, alternative =\"less\")\n    c_data$con6_auto[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n    \n    temp &lt;- t.test(ind_sample$y_imp_1_dif, ind_sample$y_imp_6_dif, alternative =\"two.sided\")\n    c_data$con6_imp[c] &lt;- ifelse(temp$p.value&gt;.05,1,0)\n    \n    \n    c_data$sample_size[c] &lt;- sample_size\n    c_data$correlation[c] &lt;- cor_temp\n    c_data$beta1[c] &lt;- beta1_temp\n    c_data$beta2[c] &lt;- beta2_temp\n    c_data$beta3[c] &lt;- beta3_temp\n    c_data$beta3[c] &lt;- beta3_temp\n  \n\n      }\n\n\n\n    if(a==1){b_data &lt;- c_data}else{\n      b_data &lt;- rbind(b_data, c_data)}\n\n\n\n\n\n\n      print(paste(a,\"/\", nrow(permutations)))\n  }\n  \n  \n  return(b_data)\n}\n\n\n# \n# mc_data &lt;- power_mc(b1_vector = b1_vector,\n#                     b2_vector = b2_vector,\n#                     b3_vector = b3_vector,\n#                     cor_vector = cor_vector,\n#                     number_of_samples = 100,\n#                     input_sample_size_vector=input_sample_size_vector)\n# \n# \n# \n\n\n\n\npower_mc_hypo &lt;- function(b1_vector, b2_vector, b3_vector,  cor_vector, number_of_samples, input_sample_size_vector, treatment_weight){\n  \n\n  \n  permutations &lt;- expand.grid(b1_vector, b2_vector, b3_vector,\n                              input_sample_size_vector, cor_vector, treatment_weight)\n  \n  \n  permutations &lt;- dplyr::rename(permutations, beta1=Var1, beta2=Var2, beta3=Var3,\n                                sample_size=Var4, cor=Var5, treatment_weight=Var6)\n  \n  permutations$treatment_weight &lt;- as.list(permutations$treatment_weight)\n  \n  startTimeTotal &lt;- Sys.time()\n  for(a in 1:nrow(permutations)){\n    cor_temp &lt;- permutations$cor[a]\n    beta1_temp &lt;- permutations$beta1[a]\n    beta2_temp &lt;- permutations$beta2[a]\n    beta3_temp &lt;- permutations$beta3[a]\n    sample_size &lt;- permutations$sample_size[a]\n    treatment_weight_temp &lt;- permutations$treatment_weight[[a]]\n    \n    \n    \n    startTime &lt;- Sys.time() \n    \n    \n    \n    c_data &lt;-as.data.frame(matrix(data=NA, \n                                  nrow=(number_of_samples),\n                                  ncol=12))\n    \n    \n    c_data &lt;- rename(c_data, \n                     H1_agg = V1,\n                     H2_agg =V2,\n                     H3_agg = V3,\n                     H4_agg=V4,\n                     H5_agg=V5,\n                     H6_agg=V6,\n                     sample_size=V7,\n                     correlation=V8,\n                     beta1=V9,\n                     beta2=V10,\n                     beta3=V11,\n                     treatment_weight=V12\n    )\n    \n    \n    for(c in 1:number_of_samples){\n      \n      ind_sample &lt;-as.data.frame(matrix(data=NA, \n                                        nrow=(sample_size),\n                                        ncol=29))\n      \n      \n      ind_sample &lt;- rename(ind_sample,\n                           y_mig_b=V1,\n                           y_imp_b=V2,\n                           y_auto_b=V3,\n                           y_off_b=V4,\n                           y_mig_1=V5,\n                           y_imp_1=V6,\n                           y_auto_1=V7,\n                           y_off_1=V8,\n                           y_mig_2=V9,\n                           y_imp_2=V10,\n                           y_auto_2=V11,\n                           y_off_2=V12,\n                           y_mig_3=V13,\n                           y_imp_3=V14,\n                           y_auto_3=V15,\n                           y_off_3=V16,\n                           y_mig_4=V17,\n                           y_imp_4=V18,\n                           y_auto_4=V19,\n                           y_off_4=V20,\n                           y_mig_5=V21,\n                           y_imp_5=V22,\n                           y_auto_5=V23,\n                           y_off_5=V24,\n                           y_mig_6=V25,\n                           y_imp_6=V26,\n                           y_auto_6=V27,\n                           y_off_6=V28,\n                           treatment=V29\n                           )\n      \n      \n      \n      treatments &lt;- c(\"C1\",\"C2\",\"C3\",\"C4\",\"C5\",\"C6\")\n      \n      ind_sample$treatment &lt;- sample(treatments, sample_size, replace=TRUE,\n                                     prob=treatment_weight_temp)\n      ind_sample$y_mig_b &lt;- rnorm(sample_size,0,1)\n      ind_sample$y_imp_b &lt;- rnorm(sample_size,0,1)\n      ind_sample$y_auto_b &lt;- rnorm(sample_size,0,1)\n      ind_sample$y_off_b &lt;- rnorm(sample_size,0,1)\n      \n      \n      \n      \n      ### Condition One (Control, Control)\n      ind_sample$y_mig_1 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_mig_1_dif &lt;- ind_sample$y_mig_1 - ind_sample$y_mig_b\n      ind_sample$y_mig_1_dif &lt;- ifelse(ind_sample$treatment==\"C1\",\n                                       ind_sample$y_mig_1_dif,\n                                       NA)\n      \n      \n      ind_sample$y_auto_1 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_auto_1_dif &lt;- ind_sample$y_auto_1 - ind_sample$y_auto_b\n      ind_sample$y_auto_1_dif &lt;- ifelse(ind_sample$treatment==\"C1\",\n                                        ind_sample$y_auto_1_dif,\n                                        NA)\n      \n      ind_sample$y_imp_1 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_imp_1_dif &lt;- ind_sample$y_imp_1 - ind_sample$y_imp_b\n      ind_sample$y_imp_1_dif &lt;- ifelse(ind_sample$treatment==\"C1\",\n                                       ind_sample$y_imp_1_dif,\n                                       NA)\n      \n      ind_sample$y_off_1 &lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_off_1_dif &lt;- ind_sample$y_off_1 - ind_sample$y_off_b\n      ind_sample$y_off_1_dif &lt;- ifelse(ind_sample$treatment==\"C1\",\n                                       ind_sample$y_off_1_dif,\n                                       NA)\n      \n      \n      \n      ### Condition Two  (Control, Offshore)\n      ind_sample$y_mig_2 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_mig_2_dif &lt;- ind_sample$y_mig_2 - ind_sample$y_mig_b\n      ind_sample$y_mig_2_dif &lt;- ifelse(ind_sample$treatment==\"C2\",\n                                       ind_sample$y_mig_2_dif,\n                                       NA)\n      \n      ind_sample$y_auto_2 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_auto_2_dif &lt;- ind_sample$y_auto_2 - ind_sample$y_auto_b\n      ind_sample$y_auto_2_dif &lt;- ifelse(ind_sample$treatment==\"C2\",\n                                        ind_sample$y_auto_2_dif,\n                                        NA)\n      \n      ind_sample$y_imp_2 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_imp_2_dif &lt;- ind_sample$y_imp_2 - ind_sample$y_imp_b\n      ind_sample$y_imp_2_dif &lt;- ifelse(ind_sample$treatment==\"C2\",\n                                       ind_sample$y_imp_2_dif,\n                                       NA)\n      \n      ind_sample$y_off_2 &lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp - 1* beta3_temp\n      ind_sample$y_off_2_dif &lt;- ind_sample$y_off_2 - ind_sample$y_off_b\n      ind_sample$y_off_2_dif &lt;- ifelse(ind_sample$treatment==\"C2\",\n                                       ind_sample$y_off_2_dif,\n                                       NA)\n      \n      \n      \n      \n      ### Condition Three  (General, Control)\n      ind_sample$y_mig_3 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n      ind_sample$y_mig_3_dif &lt;- ind_sample$y_mig_3 - ind_sample$y_mig_b\n      ind_sample$y_mig_3_dif &lt;- ifelse(ind_sample$treatment==\"C3\",\n                                       ind_sample$y_mig_3_dif,\n                                       NA)\n      \n      ind_sample$y_auto_3 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n      ind_sample$y_auto_3_dif &lt;- ind_sample$y_auto_3 - ind_sample$y_auto_b\n      ind_sample$y_auto_3_dif &lt;- ifelse(ind_sample$treatment==\"C3\",\n                                        ind_sample$y_auto_3_dif,\n                                        NA)\n      \n      ind_sample$y_imp_3 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n      ind_sample$y_imp_3_dif &lt;- ind_sample$y_imp_3 - ind_sample$y_imp_b\n      ind_sample$y_imp_3_dif &lt;- ifelse(ind_sample$treatment==\"C3\",\n                                       ind_sample$y_imp_3_dif,\n                                       NA)\n      \n      ind_sample$y_off_3&lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n      ind_sample$y_off_3_dif &lt;- ind_sample$y_off_3 - ind_sample$y_off_b\n      ind_sample$y_off_3_dif &lt;- ifelse(ind_sample$treatment==\"C3\",\n                                       ind_sample$y_off_3_dif,\n                                       NA)\n      \n      \n      \n      \n      ### Condition Four  (General, Offshore)\n      \n      ind_sample$y_mig_4 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp +.2\n      ind_sample$y_mig_4_dif &lt;- ind_sample$y_mig_4 - ind_sample$y_mig_b\n      ind_sample$y_mig_4_dif &lt;- ifelse(ind_sample$treatment==\"C4\",\n                                       ind_sample$y_mig_4_dif,\n                                       NA)\n      \n      ind_sample$y_auto_4 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n      ind_sample$y_auto_4_dif &lt;- ind_sample$y_auto_4 - ind_sample$y_auto_b\n      ind_sample$y_auto_4_dif &lt;- ifelse(ind_sample$treatment==\"C4\",\n                                        ind_sample$y_auto_4_dif,\n                                        NA)\n      \n      ind_sample$y_imp_4 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +1*beta2_temp + 0* beta3_temp\n      ind_sample$y_imp_4_dif &lt;- ind_sample$y_imp_4 - ind_sample$y_imp_b\n      ind_sample$y_imp_4_dif &lt;- ifelse(ind_sample$treatment==\"C4\",\n                                       ind_sample$y_imp_4_dif,\n                                       NA)\n      \n      ind_sample$y_off_4&lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp - 1* beta3_temp\n      ind_sample$y_off_4_dif &lt;- ind_sample$y_off_4 - ind_sample$y_off_b\n      ind_sample$y_off_4_dif &lt;- ifelse(ind_sample$treatment==\"C4\",\n                                       ind_sample$y_off_4_dif,\n                                       NA)\n      \n      \n      ### Condition Five  (Auto, Control)\n      \n      ind_sample$y_mig_5 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_mig_5_dif &lt;- ind_sample$y_mig_5 - ind_sample$y_mig_b\n      ind_sample$y_mig_5_dif &lt;- ifelse(ind_sample$treatment==\"C5\",\n                                       ind_sample$y_mig_5_dif,\n                                       NA)\n      \n      ind_sample$y_auto_5 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 1*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_auto_5_dif &lt;- ind_sample$y_auto_5 - ind_sample$y_auto_b\n      ind_sample$y_auto_5_dif &lt;- ifelse(ind_sample$treatment==\"C5\",\n                                        ind_sample$y_auto_5_dif,\n                                        NA)\n      \n      ind_sample$y_imp_5 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_imp_5_dif &lt;- ind_sample$y_imp_5 - ind_sample$y_imp_b\n      ind_sample$y_imp_5_dif &lt;- ifelse(ind_sample$treatment==\"C5\",\n                                       ind_sample$y_imp_5_dif,\n                                       NA)\n      \n      ind_sample$y_off_5&lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_off_5_dif &lt;- ind_sample$y_off_5 - ind_sample$y_off_b\n      ind_sample$y_off_5_dif &lt;- ifelse(ind_sample$treatment==\"C5\",\n                                       ind_sample$y_off_5_dif,\n                                       NA)\n      \n      \n      \n      ### Condition Six  (Auto, Offshore)\n      \n      ind_sample$y_mig_6 &lt;-rnorm_pre(ind_sample$y_mig_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_mig_6_dif &lt;- ind_sample$y_mig_6 - ind_sample$y_mig_b\n      ind_sample$y_mig_6_dif &lt;- ifelse(ind_sample$treatment==\"C6\",\n                                       ind_sample$y_mig_6_dif,\n                                       NA)\n      \n      ind_sample$y_auto_6 &lt;-rnorm_pre(ind_sample$y_auto_b, r=cor_temp) + 1*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_auto_6_dif &lt;- ind_sample$y_auto_6 - ind_sample$y_auto_b\n      ind_sample$y_auto_6_dif &lt;- ifelse(ind_sample$treatment==\"C6\",\n                                        ind_sample$y_auto_6_dif,\n                                        NA)\n      \n      ind_sample$y_imp_6 &lt;-rnorm_pre(ind_sample$y_imp_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp + 0* beta3_temp\n      ind_sample$y_imp_6_dif &lt;- ind_sample$y_imp_6 - ind_sample$y_imp_b\n      ind_sample$y_imp_6_dif &lt;- ifelse(ind_sample$treatment==\"C6\",\n                                       ind_sample$y_imp_6_dif,\n                                       NA)\n      \n      ind_sample$y_off_6&lt;-rnorm_pre(ind_sample$y_off_b, r=cor_temp) + 0*beta1_temp +0*beta2_temp - 1* beta3_temp\n      ind_sample$y_off_6_dif &lt;- ind_sample$y_off_6 - ind_sample$y_off_b\n      ind_sample$y_off_6_dif &lt;- ifelse(ind_sample$treatment==\"C6\",\n                                       ind_sample$y_off_6_dif,\n                                       NA)\n      \n      \n      \n      \n      \n      #######\n      # Hypothesis 1\n      #######\n      \n      \n      ind_sample$heigtened_specific_agg &lt;- ifelse(is.na(ind_sample$y_auto_6_dif),\n                                                  ind_sample$y_auto_5_dif,\n                                                  ind_sample$y_auto_6_dif)\n      \n      \n      ind_sample$heigtened_specific_agg_con &lt;- ifelse(is.na(ind_sample$y_auto_1_dif),\n                                                  ind_sample$y_auto_2_dif,\n                                                  ind_sample$y_auto_1_dif)\n    \n      temp &lt;- t.test(ind_sample$heigtened_specific_agg_con,\n                     ind_sample$heigtened_specific_agg,\n                     alternative =\"less\")\n      \n      c_data$H1_agg[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n      \n      ######\n      # Hypothesis 2\n      #######\n      \n      \n      ind_sample$lowered_specific_agg &lt;- ifelse(is.na(ind_sample$y_off_6_dif),\n                                                  ind_sample$y_off_2_dif,\n                                                  ind_sample$y_off_6_dif)\n      \n      \n      ind_sample$lowered_specific_agg_con &lt;- ifelse(is.na(ind_sample$y_off_1_dif),\n                                                      ind_sample$y_off_5_dif,\n                                                      ind_sample$y_off_1_dif)\n      \n      temp &lt;- t.test(ind_sample$lowered_specific_agg_con,\n                     ind_sample$lowered_specific_agg,\n                     alternative =\"greater\")\n      \n      c_data$H2_agg[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n      \n      \n      #######\n      # Hypothesis 3\n      #######\n      h3_samp &lt;-ind_sample %&gt;% dplyr::select(y_mig_1_dif, y_mig_4_dif, \n                       y_off_1_dif, y_off_4_dif,y_auto_1_dif, y_auto_4_dif,\n                       y_imp_1_dif, y_imp_4_dif)\n      \n   \n      \n      \n      h3_samp$condition &lt;- ifelse(!is.na(h3_samp$y_mig_4_dif),\n                                  \"Treatment\",\n                                  NA)\n      \n      h3_samp$condition &lt;- ifelse(!is.na(h3_samp$y_mig_1_dif),\n                                  \"Control\",\n                                  h3_samp$condition)\n      \n      h3_samp &lt;- h3_samp %&gt;% pivot_longer(cols=c(y_mig_1_dif, y_mig_4_dif, \n                                                 y_off_1_dif, y_off_4_dif,y_auto_1_dif, y_auto_4_dif,\n                                                 y_imp_1_dif, y_imp_4_dif))\n      \n      h3_samp_con &lt;- subset(h3_samp, h3_samp$condition==\"Control\")\n      h3_samp_treat &lt;- subset(h3_samp, h3_samp$condition==\"Treatment\")\n      \n      \n      \n      temp &lt;- t.test(h3_samp_con$value, h3_samp_treat$value, alternative =\"less\")\n      c_data$H3_agg[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n      \n      \n  \n      #######\n      # Hypothesis 4\n      #######\n      temp &lt;- t.test(ind_sample$y_off_3_dif, ind_sample$y_off_4_dif, alternative =\"greater\")\n      c_data$H4_agg[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n      \n      #######\n      # Hypothesis 5\n      #######\n      \n      h5_samp &lt;- ind_sample %&gt;% dplyr::select(y_auto_5_dif, y_auto_6_dif,\n                                              y_auto_3_dif, y_auto_4_dif)\n      \n      \n      \n      h5_samp$condition &lt;- ifelse(is.na(h5_samp$y_auto_5_dif) & is.na(h5_samp$y_auto_6_dif) ,\n                                  \"Control\",\n                                  \"Treatment\")\n      \n\n      \n      h5_samp &lt;- h5_samp %&gt;% pivot_longer(cols=c(y_auto_5_dif, y_auto_6_dif,\n                                                 y_auto_3_dif, y_auto_4_dif))\n      \n      \n      \n      h5_samp_con &lt;- subset(h5_samp, h5_samp$condition==\"Control\")\n      h5_samp_treat &lt;- subset(h5_samp, h5_samp$condition==\"Treatment\")\n      \n      \n      \n      temp &lt;- t.test(h5_samp_con$value, h5_samp_treat$value, alternative =\"less\")\n      c_data$H5_agg[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n      \n      #######\n      # Hypothesis 6\n      #######\n      h6_samp &lt;-ind_sample %&gt;% dplyr::select(y_off_4_dif, y_auto_4_dif,\n                                             y_mig_4_dif, y_imp_4_dif)\n      \n      h6_samp &lt;- h6_samp %&gt;%  pivot_longer(cols=c(y_off_4_dif, y_auto_4_dif,\n                                                  y_mig_4_dif, y_imp_4_dif))\n      \n      h6_samp$condition &lt;- ifelse(h6_samp$name==\"y_mig_4_dif\",\n                                  \"Treatment\",\n                                  \"Control\")\n      \n      h6_samp_con &lt;- subset(h6_samp, h6_samp$condition==\"Control\")\n      h6_samp_treat &lt;- subset(h6_samp, h6_samp$condition==\"Treatment\")\n      \n      temp &lt;- t.test(h6_samp_con$value, h6_samp_treat$value, alternative =\"less\")\n      c_data$H6_agg[c] &lt;- ifelse(temp$p.value&lt;.05,1,0)\n      \n      \n      c_data$sample_size[c] &lt;- sample_size\n      c_data$correlation[c] &lt;- cor_temp\n      c_data$beta1[c] &lt;- beta1_temp\n      c_data$beta2[c] &lt;- beta2_temp\n      c_data$beta3[c] &lt;- beta3_temp\n      c_data$treatment_weight[c] &lt;- paste(unlist(treatment_weight_temp), collapse=' ')\n      \n      \n    }\n    \n    \n    \n    if(a==1){b_data &lt;- c_data}else{\n      b_data &lt;- rbind(b_data, c_data)}\n    \n    \n  \n    endTime &lt;- Sys.time() \n    \n\n    \n    cat(paste0(\"Loop \", a,\"/\", nrow(permutations), \"\\n\",\n              \"Loop Duration: \", round(as.numeric(endTime-startTime),2), \" seconds\"),\"\\n\",\n              \"Total Duration: \", dhms(as.numeric(endTime)-as.numeric(startTimeTotal)),\"\\n\",\"###############\",\"\\n\")\n  }\n  \n  \n  return(b_data)\n}\n\nmc_data &lt;- power_mc_hypo(b1_vector = b1_vector,\n                    b2_vector = b2_vector,\n                    b3_vector = b3_vector,\n                    cor_vector = cor_vector,\n                    number_of_samples = 100,\n                    treatment_weight=treatment_weight,\n                    input_sample_size_vector=input_sample_size_vector)\n\n\n\nwrite_dta(mc_data, \n          \"update_power_analysis_results.dta\")\n\n\n\n\n \n\n\n\n\n\n\n\n\n\n\n    \n    \n    Download .dta File\n    \n\n\n\nDownload Experiment Power Analysis .dta file\nDownload"
  },
  {
    "objectID": "chap2_power_survey_plot.html#r-file-plots",
    "href": "chap2_power_survey_plot.html#r-file-plots",
    "title": "Power Analysis Plots for the Survey",
    "section": "R-File Plots",
    "text": "R-File Plots\n\n#####################################\n# From Scratch Power Analysis Monte Carlo: Survey\n######################################\n\n# Clear Environment\nrm(list=ls())\n\n\nlibrary(EnvStats, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(truncnorm, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(ggplot2, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(haven, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(readr, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(tidyverse, quietly = TRUE,  warn.conflicts=FALSE)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ stringr   1.5.1\n✔ forcats   1.0.0     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(MASS, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(ggplot2, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(dplyr, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(tidyr, quietly = TRUE,  warn.conflicts=FALSE)\nlibrary(faux, quietly = TRUE,  warn.conflicts=FALSE)\n\n\n************\nWelcome to faux. For support and examples visit:\nhttps://debruine.github.io/faux/\n- Get and set global package options with: faux_options()\n************\n\nmcdata &lt;- read_dta(\"DTA_Files/survey_power_analysis.dta\")\n\n# mcdata &lt;- read_dta(\"update_power_analysis_results_mediation.dta\")\n\n\n\n\nmc_data_sum &lt;- mcdata %&gt;% group_by(sample_size, beta1, beta2, beta3,beta4,beta5,beta6,beta7) %&gt;%\n  dplyr::summarize(H1_mig = sum(H1_agg_mig),\n            H1_imp = sum(H1_agg_imp),\n            H1_auto = sum(H1_agg_auto),\n            H1_off = sum(H1_agg_off),\n            H2_mig = sum(H2_agg_mig),\n            H2_imp = sum(H2_agg_imp),\n            H2_auto = sum(H2_agg_auto),\n            H2_off = sum(H2_agg_off),\n            H3_mig = sum(H3_agg_mig),\n            H3_imp = sum(H3_agg_imp),\n            H3_auto = sum(H3_agg_auto),\n            H3_off = sum(H3_agg_off),\n            H4_mig = sum(H4_agg_mig),\n            H4_imp = sum(H4_agg_imp),\n            H4_auto = sum(H4_agg_auto),\n            H4_off = sum(H4_agg_off),\n            H5_imp = sum(H5_agg_imp),\n            H5_auto = sum(H5_agg_auto),\n            H5_off = sum(H5_agg_off),\n            H6_mig = sum(H6_agg_mig),\n            H6_imp = sum(H6_agg_imp),\n            H6_auto = sum(H6_agg_auto),\n            H6_off = sum(H6_agg_off),\n            H7_mig = sum(H7_agg_mig),\n            H7_imp = sum(H7_agg_imp),\n            H7_auto = sum(H7_agg_auto),\n            H7_off = sum(H7_agg_off)\n  )\n\n`summarise()` has grouped output by 'sample_size', 'beta1', 'beta2', 'beta3',\n'beta4', 'beta5', 'beta6'. You can override using the `.groups` argument.\n\nmc_data_sum$beta1_factor &lt;- as.character(mc_data_sum$beta1)\nmc_data_sum$beta2_factor &lt;- as.character(mc_data_sum$beta2)\nmc_data_sum$beta3_factor &lt;- as.character(mc_data_sum$beta3)\nmc_data_sum$beta4_factor &lt;- as.character(mc_data_sum$beta4)\nmc_data_sum$beta5_factor &lt;- as.character(mc_data_sum$beta5)\nmc_data_sum$beta6_factor &lt;- as.character(mc_data_sum$beta6)\nmc_data_sum$beta7_factor &lt;- as.character(mc_data_sum$beta7)\n\nmc_data_sum$beta1_factor &lt;- paste(\"Beta 1 Size:\", mc_data_sum$beta1_factor, sep = \" \")\nmc_data_sum$beta2_factor &lt;- paste(\"Beta 2 Size:\", mc_data_sum$beta2_factor, sep = \" \")\nmc_data_sum$beta3_factor &lt;- paste(\"Beta 3 Size:\", mc_data_sum$beta3_factor, sep = \" \")\nmc_data_sum$beta4_factor &lt;- paste(\"Beta 4 Size:\", mc_data_sum$beta4_factor, sep = \" \")\nmc_data_sum$beta5_factor &lt;- paste(\"Beta 5 Size:\", mc_data_sum$beta5_factor, sep = \" \")\nmc_data_sum$beta6_factor &lt;- paste(\"Beta 6 Size:\", mc_data_sum$beta6_factor, sep = \" \")\nmc_data_sum$beta7_factor &lt;- paste(\"Beta 7 Size:\", mc_data_sum$beta7_factor, sep = \" \")\n\n\n\n\n\n\n\n\n\nmc_data_H1 &lt;- mc_data_sum %&gt;% tidyr::pivot_longer(cols=c(H1_mig, H1_imp, H1_auto, H1_off), names_to = \"H1\",values_to = \"H1_agg\")\n\nmc_data_H2 &lt;- mc_data_sum %&gt;% tidyr::pivot_longer(cols=c(H2_mig, H2_imp, H2_auto, H2_off), names_to = \"H2\",values_to = \"H2_agg\")\n\nmc_data_H3 &lt;- mc_data_sum %&gt;% tidyr::pivot_longer(cols=c(H3_mig, H3_imp, H3_auto, H3_off), names_to = \"H3\",values_to = \"H3_agg\")\n\nmc_data_H4 &lt;- mc_data_sum %&gt;% tidyr::pivot_longer(cols=c(H4_mig, H4_imp, H4_auto, H4_off), names_to = \"H4\",values_to = \"H4_agg\")\n\nmc_data_H5 &lt;- mc_data_sum %&gt;% tidyr::pivot_longer(cols=c(H5_imp, H5_auto, H5_off), names_to = \"H5\",values_to = \"H5_agg\")\n\nmc_data_H6 &lt;- mc_data_sum %&gt;% tidyr::pivot_longer(cols=c(H6_mig, H6_imp, H6_auto, H6_off), names_to = \"H6\",values_to = \"H6_agg\")\n\nmc_data_H7&lt;- mc_data_sum %&gt;% tidyr::pivot_longer(cols=c(H7_mig, H7_imp, H7_auto, H7_off), names_to = \"H7\",values_to = \"H7_agg\")\n\n\nmc_data_H1$H1 &lt;- replace(mc_data_H1$H1, mc_data_H1$H1==\"H1_auto\",\"Automation\")\nmc_data_H1$H1 &lt;- replace(mc_data_H1$H1, mc_data_H1$H1==\"H1_imp\",\"Imports\")\nmc_data_H1$H1 &lt;- replace(mc_data_H1$H1, mc_data_H1$H1==\"H1_off\",\"Offshoring\")\nmc_data_H1$H1 &lt;- replace(mc_data_H1$H1, mc_data_H1$H1==\"H1_mig\",\"Migration\")\n\nmc_data_H2$H2 &lt;- replace(mc_data_H2$H2, mc_data_H2$H2==\"H2_auto\",\"Automation\")\nmc_data_H2$H2 &lt;- replace(mc_data_H2$H2, mc_data_H2$H2==\"H2_imp\",\"Imports\")\nmc_data_H2$H2 &lt;- replace(mc_data_H2$H2, mc_data_H2$H2==\"H2_off\",\"Offshoring\")\nmc_data_H2$H2 &lt;- replace(mc_data_H2$H2, mc_data_H2$H2==\"H2_mig\",\"Migration\")\n\nmc_data_H3$H3 &lt;- replace(mc_data_H3$H3, mc_data_H3$H3==\"H3_auto\",\"Automation\")\nmc_data_H3$H3 &lt;- replace(mc_data_H3$H3, mc_data_H3$H3==\"H3_imp\",\"Imports\")\nmc_data_H3$H3 &lt;- replace(mc_data_H3$H3, mc_data_H3$H3==\"H3_off\",\"Offshoring\")\nmc_data_H3$H3 &lt;- replace(mc_data_H3$H3, mc_data_H3$H3==\"H3_mig\",\"Migration\")\n\nmc_data_H4$H4 &lt;- replace(mc_data_H4$H4, mc_data_H4$H4==\"H4_auto\",\"Automation\")\nmc_data_H4$H4 &lt;- replace(mc_data_H4$H4, mc_data_H4$H4==\"H4_imp\",\"Imports\")\nmc_data_H4$H4 &lt;- replace(mc_data_H4$H4, mc_data_H4$H4==\"H4_off\",\"Offshoring\")\nmc_data_H4$H4 &lt;- replace(mc_data_H4$H4, mc_data_H4$H4==\"H4_mig\",\"Migration\")\n\nmc_data_H5$H5 &lt;- replace(mc_data_H5$H5, mc_data_H5$H5==\"H5_auto\",\"Automation\")\nmc_data_H5$H5 &lt;- replace(mc_data_H5$H5, mc_data_H5$H5==\"H5_imp\",\"Imports\")\nmc_data_H5$H5 &lt;- replace(mc_data_H5$H5, mc_data_H5$H5==\"H5_off\",\"Offshoring\")\nmc_data_H5$H5 &lt;- replace(mc_data_H5$H5, mc_data_H5$H5==\"H5_mig\",\"Migration\")\n\nmc_data_H6$H6 &lt;- replace(mc_data_H6$H6, mc_data_H6$H6==\"H6_auto\",\"Automation\")\nmc_data_H6$H6 &lt;- replace(mc_data_H6$H6, mc_data_H6$H6==\"H6_imp\",\"Imports\")\nmc_data_H6$H6 &lt;- replace(mc_data_H6$H6, mc_data_H6$H6==\"H6_off\",\"Offshoring\")\nmc_data_H6$H6 &lt;- replace(mc_data_H6$H6, mc_data_H6$H6==\"H6_mig\",\"Migration\")\n\nmc_data_H7$H7 &lt;- replace(mc_data_H7$H7, mc_data_H7$H7==\"H7_auto\",\"Automation\")\nmc_data_H7$H7 &lt;- replace(mc_data_H7$H7, mc_data_H7$H7==\"H7_imp\",\"Imports\")\nmc_data_H7$H7 &lt;- replace(mc_data_H7$H7, mc_data_H7$H7==\"H7_off\",\"Offshoring\")\nmc_data_H7$H7 &lt;- replace(mc_data_H7$H7, mc_data_H7$H7==\"H7_mig\",\"Migration\")\n\n\n\nh1_plot &lt;- mc_data_H1 %&gt;% ggplot(aes(x=sample_size, y=H1_agg, color=H1))+\n  geom_smooth()+\n  ylim(0,100)+\n  geom_hline(yintercept=95, col=\"red\",lty=\"dashed\", size=1)+\n  labs(title=\"Power Analysis for Hypothesis 1\",x=\"Sample Size\",color=\"Outcome Variable\",\n       y=\"Powered Samples\")+\n  facet_wrap(~beta1_factor)+\n  theme_light()+\n  theme(plot.title = element_text(hjust = 0.5));h1_plot\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\nWarning: Removed 253 rows containing missing values or values outside the scale range\n(`geom_smooth()`).\n\n\n\n\n\n\n\n\n# ggsave(\"Graphics/survey_h1_plot.png\")\n\nh2_plot &lt;- mc_data_H2 %&gt;% ggplot(aes(x=sample_size, y=H2_agg, color=H2))+\n  geom_smooth()+\n  ylim(0,100)+\n  geom_hline(yintercept=95, col=\"red\",lty=\"dashed\", size=1)+\n  labs(title=\"Power Analysis for Hypothesis 2\",x=\"Sample Size\",color=\"Outcome Variable\",\n       y=\"Powered Samples\")+\n  facet_wrap(~beta2_factor)+\n  theme_light()+\n  theme(plot.title = element_text(hjust = 0.5));h2_plot\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\nWarning: Removed 212 rows containing missing values or values outside the scale range\n(`geom_smooth()`).\n\n\n\n\n\n\n\n\n# ggsave(\"Graphics/survey_h2_plot.png\")\n\nh3_plot &lt;- mc_data_H3 %&gt;% ggplot(aes(x=sample_size, y=H3_agg, color=H3))+\n  geom_smooth()+\n  ylim(0,100)+\n  geom_hline(yintercept=95, col=\"red\",lty=\"dashed\", size=1)+\n  labs(title=\"Power Analysis for Hypothesis 3\",x=\"Sample Size\",color=\"Outcome Variable\",\n       y=\"Powered Samples\")+\n  facet_wrap(~beta1_factor + beta2_factor)+\n  theme_light()+\n  theme(plot.title = element_text(hjust = 0.5));h3_plot\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\nWarning: Removed 326 rows containing missing values or values outside the scale range\n(`geom_smooth()`).\n\n\n\n\n\n\n\n\n# ggsave(\"Graphics/survey_h3_plot.png\")\n\nh4_plot &lt;- mc_data_H4 %&gt;% ggplot(aes(x=sample_size, y=H4_agg, color=H4))+\n  geom_smooth()+\n  ylim(0,105)+\n  geom_hline(yintercept=95, col=\"red\",lty=\"dashed\", size=1)+\n  labs(title=\"Power Analysis for Hypothesis 4\",x=\"Sample Size\",color=\"Outcome Variable\",\n       y=\"Powered Samples\")+\n#  facet_wrap(~beta3_factor + beta6_factor + beta2_factor)+\n  theme_light()+\n  theme(plot.title = element_text(hjust = 0.5));h4_plot\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\n\n\n# ggsave(\"Graphics/survey_h4_plot.png\")\n\nh5_plot &lt;- mc_data_H5 %&gt;% ggplot(aes(x=sample_size, y=H5_agg, color=H5))+\n  geom_smooth()+\n  ylim(0,110)+\n  geom_hline(yintercept=95, col=\"red\",lty=\"dashed\", size=1)+\n  labs(title=\"Power Analysis for Hypothesis 5\",x=\"Sample Size\",color=\"Outcome Variable\",\n       y=\"Powered Samples\")+\n   facet_wrap(~beta3_factor)+\n  theme_light()+\n  theme(plot.title = element_text(hjust = 0.5));h5_plot\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\n\n\n# ggsave(\"Graphics/survey_h5_plot.png\")\n\nh6_plot &lt;- mc_data_H6 %&gt;% ggplot(aes(x=sample_size, y=H6_agg, color=H6))+\n  geom_smooth()+\n  ylim(0,110)+\n  geom_hline(yintercept=95, col=\"red\",lty=\"dashed\", size=1)+\n  labs(title=\"Power Analysis for Hypothesis 6\",x=\"Sample Size\",color=\"Outcome Variable\",\n       y=\"Powered Samples\")+\n  facet_wrap(~beta5_factor + beta2_factor)+\n  theme_light()+\n  theme(plot.title = element_text(hjust = 0.5));h6_plot\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\n\n\n# ggsave(\"Graphics/survey_h6_plot.png\")\n\nh7_plot &lt;- mc_data_H7 %&gt;% ggplot(aes(x=sample_size, y=H7_agg, color=H7))+\n  geom_smooth()+\n  ylim(0,110)+\n  geom_hline(yintercept=95, col=\"red\",lty=\"dashed\", size=1)+\n  labs(title=\"Power Analysis for Hypothesis 7\",x=\"Sample Size\",color=\"Outcome Variable\",\n       y=\"Powered Samples\")+\n  theme_light()+\n  theme(plot.title = element_text(hjust = 0.5));h7_plot\n\n`geom_smooth()` using method = 'loess' and formula = 'y ~ x'\n\n\n\n\n\n\n\n\n# ggsave(\"Graphics/survey_h7_plot.png\")"
  }
]